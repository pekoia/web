"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[903],{33918:function(o,e,n){n.d(e,{Z:function(){return R}});var t=n(30168),a=n(63366),r=n(87462),i=n(67294),s=n(2585),c=n(11340),l=n(4382),u=n(37355),d=n(55437),g=n(33909),f=n(81042);function m(o){return(0,f.Z)("MuiCircularProgress",o)}(0,n(18851).Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var p,v,E,S,h,k,A,w,L=n(85893),C=["className","color","disableShrink","size","style","thickness","value","variant"],b=44,M=(0,l.keyframes)(h||(h=p||(p=(0,t.Z)(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),x=(0,l.keyframes)(k||(k=v||(v=(0,t.Z)(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"])))),y=(0,g.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:function(o,e){var n=o.ownerState;return[e.root,e[n.variant],e["color".concat((0,u.Z)(n.color))]]}})((function(o){var e=o.ownerState,n=o.theme;return(0,r.Z)({display:"inline-block"},"determinate"===e.variant&&{transition:n.transitions.create("transform")},"inherit"!==e.color&&{color:n.palette[e.color].main})}),(function(o){return"indeterminate"===o.ownerState.variant&&(0,l.css)(A||(A=E||(E=(0,t.Z)(["\n      animation: "," 1.4s linear infinite;\n    "]))),M)})),D=(0,g.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:function(o,e){return e.svg}})({display:"block"}),O=(0,g.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:function(o,e){var n=o.ownerState;return[e.circle,e["circle".concat((0,u.Z)(n.variant))],n.disableShrink&&e.circleDisableShrink]}})((function(o){var e=o.ownerState,n=o.theme;return(0,r.Z)({stroke:"currentColor"},"determinate"===e.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(function(o){var e=o.ownerState;return"indeterminate"===e.variant&&!e.disableShrink&&(0,l.css)(w||(w=S||(S=(0,t.Z)(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),x)})),R=i.forwardRef((function(o,e){var n=(0,d.Z)({props:o,name:"MuiCircularProgress"}),t=n.className,i=n.color,l=void 0===i?"primary":i,g=n.disableShrink,f=void 0!==g&&g,p=n.size,v=void 0===p?40:p,E=n.style,S=n.thickness,h=void 0===S?3.6:S,k=n.value,A=void 0===k?0:k,w=n.variant,M=void 0===w?"indeterminate":w,x=(0,a.Z)(n,C),R=(0,r.Z)({},n,{color:l,disableShrink:f,size:v,thickness:h,value:A,variant:M}),P=function(o){var e=o.classes,n=o.variant,t=o.color,a=o.disableShrink,r={root:["root",n,"color".concat((0,u.Z)(t))],svg:["svg"],circle:["circle","circle".concat((0,u.Z)(n)),a&&"circleDisableShrink"]};return(0,c.Z)(r,m,e)}(R),N={},I={},Z={};if("determinate"===M){var B=2*Math.PI*((b-h)/2);N.strokeDasharray=B.toFixed(3),Z["aria-valuenow"]=Math.round(A),N.strokeDashoffset="".concat(((100-A)/100*B).toFixed(3),"px"),I.transform="rotate(-90deg)"}return(0,L.jsx)(y,(0,r.Z)({className:(0,s.Z)(P.root,t),style:(0,r.Z)({width:v,height:v},I,E),ownerState:R,ref:e,role:"progressbar"},Z,x,{children:(0,L.jsx)(D,{className:P.svg,ownerState:R,viewBox:"".concat(22," ").concat(22," ").concat(b," ").concat(b),children:(0,L.jsx)(O,{className:P.circle,style:N,ownerState:R,cx:b,cy:b,r:(b-h)/2,fill:"none",strokeWidth:h})})}))}))},3973:function(o,e){e.Z={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"}},57962:function(o,e,n){n.d(e,{Z:function(){return s}});n(67294);var t=n(10520),a=n(76907),r=n(85893),i=(0,a.default)({key:"css",prepend:!0});function s(o){var e=o.injectFirst,n=o.children;return e?(0,r.jsx)(t.C,{value:i,children:n}):n}},11197:function(o,e,n){n.r(e),n.d(e,{default:function(){return H}});var t=n(67294),a=n(11947),r=n(68923),i=n(7391),s=n(99216),c=n(13775),l=n(19176),u=n(59959),d=n(17990),g=n(69490),f=n(75701),m=n(98871),p=n(43316),v=n(83472),E=n(7703),S=n(75111),h=n(21370),k="PAGE_HOMEPAGE",A="PAGE_HOMEPAGE_NOTLOGGED",w="PAGE_WITHACCOUNT",L="PAGE_WITHNOACCOUNT",C="PAGE_PAIEMENTNOACCOUNT",b="PAGE_NEWACCOUNT",M="PAGE_NOUVEAUMDP",x={attach:function(o,e){var n=x.scope.find((function(e){return e.name===o}));Object.keys(e).forEach((function(o){return n[o]=e[o]}))},scope:[{name:k,displayComponent:c.Z},{name:A,displayComponent:c.Z},{name:w,displayComponent:l.Z},{name:L,displayComponent:u.Z},{name:C,displayComponent:p.Z},{name:s.aN,displayComponent:d.Z},{name:b,displayComponent:m.Z},{name:s.R3,displayComponent:g.Z},{name:M,displayComponent:f.Z}]},y=function(o){return{moveTo:function(e,n){var t;o.setLocalState(Object.assign({},o.localState,((t={})[s.c9]="",t[s.Th]=e+n,t)))},increaseCount:function(){var e;return o.setLocalState(Object.assign({},o.localState,((e={})[s.ai]=o.localState+1,e)))},displayErrorMessage:function(e){var n;return o.setLocalState(Object.assign({},o.localState,((n={})[s.c9]=e,n)))}}},D={onClickMainButton:function(o){o.isLogged?y(o).moveTo(w,"A"):y(o).moveTo(s.aN,"A")},onClickSecondButton:function(o){y(o).moveTo(L,"A")}},O={onClickMainButton:function(o){var e=o.localState;if((0,E.Sf)(e[s.xK])){var n={available:function(){return y(o).displayErrorMessage("Il n'y aucun compte Pekoia associé à cet email")},notConfirmed:function(){return y(o).moveTo("PAGE_3","A")},notAvailable:function(){return y(o).moveTo("PAGE_0","B")}};(0,S.S)(e[s.xK],n)}else y(o).displayErrorMessage("format email incorrect")},onClickSecondButton:function(o){var e=o.localState;if((0,E.Sf)(e[s.xK])){var n={available:function(){return y(o).moveTo("PAGE_2","A")},notConfirmed:function(){return console.log("B")},notAvailable:function(){return y(o).displayErrorMessage("Cet email a déja été utilisé.")}};(0,S.S)(e[s.xK],n)}else y(o).displayErrorMessage("format email incorrect")}},R={onClickMainButton:function(o){if(!0===o.isLogged)return o.currentProcess.closeHandler(),null;o.setLocalState(Object.assign({},o.localState,{SPINNER:!0})),(0,v.t)(o)}},P={onClickMainButton:function(o){y(o).moveTo(C,"A")}},N={onClickMainButton:function(o){o.setLocalState(Object.assign({},o.localState,{SPINNER:!0})),(0,v.t)(Object.assign({},o,{guest:!0}))}},I={onClickMainButton:function(o){var e=o.localState,n=o.setLocalState,t=o.currentProcess;if(2===o.showLoginModal)return y(o).moveTo(b,"A"),null;y(o).displayErrorMessage(""),(0,S.u)({email:e.EMAIL,password:e.PASSWORD,callback:function(o){t.setAuthData(o),(0,h.FQ)(o,t.setAuthData),t.closeHandler()},onError:function(t){var a,r,i="connexion impossible";(t.toString().includes("NotAuthorizedException")&&(i="login ou mot de passe incorrect."),t.toString().includes("UserNotFoundException")&&(i="login ou mot de passe incorrect."),null!==(a=t.code)&&void 0!==a&&a.includes("NotConfirmed"))?y(o).moveTo(s.R3,"B"):n(Object.assign({},e,((r={})[s.c9]=i,r)))}}).signIn()},onClickSecondButton:function(o){return y(o).moveTo(b,"A")},onClickThirdButton:function(o){console.log("@MOVE-TO-B"),y(o).moveTo(M,"A")}},Z={onClickMainButton:function(o){var e=o.localState;y(o).displayErrorMessage(""),o.authActions.setConsentData(!0),(0,S.u)({email:e.EMAIL,password:e.PASSWORD,callback:function(){return y(o).moveTo(s.R3,"B")},onError:function(e){console.log("*** ERROR: A ****"),console.log(e);var n="problème de connexion";e.toString().includes("UsernameExistsException:")&&(n="ce login existe déja."),e.toString().includes("CodeDeliveryFailureException")&&(n="problème d'envoi de mail.\nVeuillez nous contacter à l'adresse suivante: contact@pekoia.com"),y(o).displayErrorMessage(n)}}).signUp()},onClickSecondButton:function(o){return y(o).moveTo(s.aN,"A")},onClickThirdButton:function(o){}},B={onClickMainButton:function(o){console.log("@FORGOT-A");var e=o.localState,n=o.setLocalState;(0,S.u)({email:e.EMAIL,callback:function(){console.log("@CONF-B"),y(o).moveTo(s.R3,"A")},onError:function(o){var t,a="-- problème de connexion --";console.log("@ERROR"),console.log(null==o?void 0:o.toString());null!=o&&o.toString().includes("LimitExceededException")&&(a="Nombre de tentatives excessif. Essayez à nouveau plus tard."),null!=o&&o.toString().includes("Cannot reset password for the user as there is no registered/verified email or phone_number")&&(a="Impossible de réinitialiser le mot de passe (compte non confirmé). Confirmez votre compte en vous connectant."),null!=o&&o.toString().includes("UserNotFoundException:")&&(a="erreur: login inexistant."),n(Object.assign({},e,((t={})[s.c9]=a,t)))}}).forgot()},onClickButton:function(o){var e=o.localState;y(o).displayErrorMessage(""),(0,S.u)({email:e.EMAIL,callback:function(){y(o).displayErrorMessage("un nouveau code vous a été envoyé.")},onError:function(e){console.log("@ERROR - R"),console.log(e),y(o).displayErrorMessage("problème de connexion")}}).resendSignUp()}},T={onClickMainButton:function(o){console.log("@WKF-MAIN"),y(o).displayErrorMessage("");var e=o.localState,n=o.setLocalState,t=o.currentProcess;y(o).displayErrorMessage(""),(0,S.u)({email:e.EMAIL,digits:e.DIGITS.join(""),callback:function(){(0,S.u)({email:e.EMAIL,password:e.PASSWORD,callback:function(o){t.setAuthData(o),t.closeHandler(),(0,h.FQ)(o,t.setAuthData,0,e.CONSENT)},onError:function(){var o;return n(Object.assign({},e,((o={})[s.c9]="problème de connexion-C",o)))}}).signIn()},onError:function(o){var t;console.log("*** ERROR: B ****");var a="problème de connexion";o.toString().includes("CodeMismatchException:")&&(a="code de vérification faux."),console.log("@ERROR-D"),console.log(o),n(Object.assign({},e,((t={})[s.c9]=a,t)))}}).confirmSignUp()},onClickButton:function(o){var e=o.localState;y(o).displayErrorMessage(""),(0,S.u)({email:e.EMAIL,callback:function(){y(o).displayErrorMessage("un nouveau code vous a été envoyé.")},onError:function(e){console.log("@ERROR - R"),console.log(e),y(o).displayErrorMessage("problème de connexion")}}).resendSignUp()}},j={onClickMainButton:function(o){console.log("@WKF-B"),y(o).displayErrorMessage("");var e=o.localState,n=o.setLocalState,t=o.currentProcess;y(o).displayErrorMessage(""),(0,S.u)({email:e.EMAIL,password:e.PASSWORD,digits:e.DIGITS.join(""),callback:function(){(0,S.u)({email:e.EMAIL,password:e.PASSWORD,callback:function(o){t.setAuthData(o),t.closeHandler(),(0,h.FQ)(o,t.setAuthData)},onError:function(){var o;return n(Object.assign({},e,((o={})[s.c9]="problème de connexion-G",o)))}}).signIn()},onError:function(o){var t;console.log("@ERR-F"),console.log(o),n(Object.assign({},e,((t={})[s.c9]="problème de connexion-F",t)))}}).confirmSignUp()}},_={onClickMainButton:function(o){console.log("@WKF-A"),y(o).displayErrorMessage("");var e=o.localState,n=o.setLocalState,t=o.currentProcess;y(o).displayErrorMessage(""),console.log("@CLICK MAIN BUTTON"),(0,S.u)({email:e.EMAIL,password:e.PASSWORD,digits:e.DIGITS.join(""),callback:function(){(0,S.u)({email:e.EMAIL,password:e.PASSWORD,callback:function(o){t.setAuthData(o),t.closeHandler(),(0,h.FQ)(o,t.setAuthData)},onError:function(){var o;return n(Object.assign({},e,((o={})[s.c9]="problème de connexion-I",o)))}}).signIn()},onError:function(o){var t;console.log("@ERR"),console.log(o);var a="problème de connexion";o.toString().includes("ExpiredCodeException: Invalid code provided")&&(a="votre code est expiré. Demandez en un nouveau."),o.toString().includes("LimitExceededException")&&(a="Nombre de tentatives excessif. Essayez à nouveau plus tard."),o.toString().includes("CodeMismatchException")&&(a="code de vérification invalide. Veuillez re-essayer"),n(Object.assign({},e,((t={})[s.c9]=a,t)))}}).forgotPasswordSubmit()}};x.attach(k,{stagesLogic:[{name:"A",workflowLogic:D,internalDescription:"homagepage in case no user is not logged"},{name:"B",workflowLogic:D,internalDescription:"homagepage in case no user is logged"}]}),x.attach(A,{stagesLogic:[{name:"A",workflowLogic:O,internalDescription:"homagepage in case no user is logged"}]}),x.attach(w,{workflowLogic:R,stagesLogic:[{name:"A",workflowLogic:R,internalDescription:"user is already logged. Directly funneled to the paiement"}]}),x.attach(L,{workflowLogic:P,stagesLogic:[{name:"A",workflowLogic:P,internalDescription:"user is already logged. Directly funneled to the paiement"}]}),x.attach(C,{workflowLogic:N,stagesLogic:[{name:"A",workflowLogic:N,internalDescription:"paiement in case user has no accounr"}]}),x.attach(s.aN,{workflowLogic:I,stagesLogic:[{name:"A",workflowLogic:I,internalDescription:"login page"},{name:"B",workflowLogic:I,internalDescription:"login page"}]}),x.attach(b,{workflowLogic:Z,stagesLogic:[{name:"A",workflowLogic:Z,internalDescription:"new account page"}]}),x.attach(M,{workflowLogic:B,stagesLogic:[{name:"A",workflowLogic:B,internalDescription:"page in case password has been lost"}]}),x.attach(s.R3,{workflowLogic:T,stagesLogic:[{name:"A",workflowLogic:_,internalDescription:"confirmation of 6 digits code"},{name:"B",workflowLogic:j,internalDescription:"confirmation in case of password reset"}]});var F=[];x.scope.forEach((function(o){o.stagesLogic.forEach((function(e){F.push({page:{workflowLogic:o.workflowLogic},workflowLogic:e.workflowLogic,component:o.displayComponent,name:o.name+e.name})}))}));var G=F,U=n(4382),W=function(o){var e=o.children;return(0,U.jsx)(r.Z,{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh",bgcolor:"#FFFFFFA0"},e)},H=function(){var o,e=(0,t.useContext)(i.Vo),n=e.authState,r=e.authActions,c=(0,t.useState)((0,s.E3)(n)),l=c[0],u=c[1];(0,t.useEffect)((function(){u((0,s.E3)(n))}),[n.showLoginModal]);var d=n.showLoginModal,g=G.find((function(o){return o.name===l[s.Th]})),f=Object.assign({},g,{closeHandler:function(){u((0,s.E3)(n)),r.toggleLoginModal()},setAuthData:r.setUserData,setCookies:r.setCookies});return f.component?(0,U.jsx)("div",null,(0,U.jsx)(a.Z,{open:Boolean(d),onClose:function(){}},(0,U.jsx)("div",null,(0,U.jsx)(W,null,(0,t.createElement)(f.component,{currentProcess:f,localState:l,setLocalState:u,isLogged:!(null===(o=n.user)||void 0===o||!o.id),showLoginModal:n.showLoginModal}))))):null}}}]);
//# sourceMappingURL=903-b8f0a909ec5d9c574036.js.map